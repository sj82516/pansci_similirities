文 ／ 曾吉弘 CAVE 教育 團隊 延續 上期 手機 遙控 機器人 本期 要將 Android 做成 一臺 手持式 資訊 面板 持續 更新 NXT 機器人 四種 感測器 資訊 NXT 機器人 準備 好 依序 將觸 碰 感測器 聲音 感測器 感測器 超音波 感測器 接在 NXT 號 輸入 端 之後 自行 修改 感應器 連接埠 請 先 確認 NXT 主機 藍牙 啟動 請將 NXT 主機 Android 手機 進行 藍牙 配對 完成 之後 機器人 放到 一邊 啟動 藍牙 之後 NXT 主機 螢幕 左上角 看到 藍牙 符號 圖 圖   NXT 主機 藍牙 已 開啟 左上角 依序 介紹 App   Inventor 程式 功能 STEP1 首次 進入 程式 畫面 如圖 看到   [ 連線 ] 按鈕 [ 斷線 ] 按鈕 無法 按下 Enabled 屬性 設為 false 這時候 只能 點選 [ 連線 ] 按鈕 圖   程式 首次 執行 畫面 STEP2 是將 ListPickerConnect 清單 指定 已 配對 藍牙 裝置 清單 圖 點選 [ 連線 ] 按鈕 之後 進入 Android 裝置 藍牙 連線 清單 圖 請 找到 剛剛 配對 完成 NXT 主機 名稱 範例 abc 點選 之後 Android 裝置 NXT 主機 發起 藍牙 連線 跳 回主 畫面 之後 看到 感測器 資訊 已經 更新 Android 裝置 畫 請 注意 NXTList AfterPicking 事件 中 加入 一個 if 判斷 是否 成功 建立 藍牙 連線 BluetoothClient Connect 如圖 處理 非 預期 情況 下 斷線 情形 機器人 沒電 關機 手機 來電 狀況 檢測 步驟 避免 程式 發生 錯誤 圖 中 下方 NxtSensorLight1 GenerateLight 指令 使光 感測器 前端 發出 紅光 True 改為 Flase 關閉 感測器 前端 光源 圖   ListPickerConnect 清單 內容 指定 已 配對 藍牙 裝置 清單 圖   Android 裝置 藍牙 連線 清單 圖   再次 檢查 藍牙 連線 是否 成功 STEP3 程式 關鍵 一步 使用 Clock 元件 定時 更新 感測器 值 App   Inventor 中 所有 時間 功能 包括 時鐘 計時器 碼錶 Clock 元件 負責 請將 Clock 元件 屬性 如圖 設定 代表 200 毫秒 觸發 一次 計時器 希望 感測器 更新 數值 頻率 圖   Clock 元件 屬性 設定 連接埠 順序 介紹 感測器 運作 方法 App   Inventor 透過 NxtTouchSensor1 IsPressed 偵測 觸碰 感測器 是否 壓下 壓下 True 程式 一個 if else 結構 更換 按鈕 底色 達到 燈號 效果 請 注意 App   Inventor 抓回 聲音 感測器 感測器 值為 原始 raw 值 介於 1023 之間 音量 愈大 從圖 中 看到 聲音 感測器 原始 值 除以 10.23 換算 成 百分比 值 最後 超音波 感測器 一種 I2C 數位 感測器 直接 超音波 發射 後 撞 物體 後 回傳 時間 換算 距離 之後 顯示 螢幕上 單位 公分 圖   感測器 值 更新 畫面 圖   使用 Clock 元件 定時 更新 感測器 值 STEP4 按下 [ 斷線 ] 按鈕 之後 斷開 藍牙 連線 BluetoothClient Disconnect 並使 按鈕 恢復 未 連線 時 狀態 這時候 再次 發起 連線 圖   按下 [ 斷線 ] 按鈕 時 中斷 藍牙 連線 STEP5 範例 加入 超 連結 功能 一期 範例 跳轉 CAVE 官方網站 http www cavedu com 這次 跳 App   Inventor 中文 學習網 許多 豐富 App   Inventor 教學 範例 課程 說明 請 點選 畫面 下方 可愛 圖樣 點選 之後 跳 App   Inventor 中文 學習網 這是 藉由 App   Inventor ActivityStarter 呼叫 Android 裝置 WebKit 瀏覽器 網址 是從 DataUri 指定 http www appinventor tw 圖 10   點選 CAVE 圖案 跳 App   Inventor 中文 學習網 實際 執行 請 先 確認 NXT 已經 開機 藍牙 啟動 Android 裝置 點選 程式 畫面 中 「 連線 」 按鈕 點選 NXT 主機 名稱 自動 連線 連線 完成 看到 感測器 值 不停 更新 請 注意 程式 尚未 進行 藍牙 連線 時 程式 會試 著去 抓 感測器 值 抓 不到 這也 圖 中 感測器 值會 原因 代表 無 設備 無 連線 感測器 值 真的 藍牙 發送 接收 訊號 皆 一定 延遲時間 30 40 毫秒 設定 計時器 觸發 頻率 200 毫秒 加加 0.3 秒 實際 執行 時 感測器 值 更新 有點 lag 這是 正常 感測器 反應 會頓 頓 使用 過樂高 機器人 朋友   一定 螢幕上 檢視 感應器 數值 經驗 應該 相當 順暢 那為 Android   手機 變得 頓頓   好像 慢半拍 感覺 原因 在於 藍牙 傳輸 來回 需要 時間 是從 Android   手機 端 NXT   機器人 發出 要求 請 傳回 指定 感應器 數值 機器人 接收 之後 回傳 一來一往 各會用 掉 30   ∼   40   毫秒 相加 最大 會用 掉 0.08   秒 已經 感覺得到 延遲時間 直接 NXT   機器人 端 直接 觀看 數值 來得 慢 感覺 囉 比較 卡通片 一秒 24   張圖 0.042   秒換 一張 圖 一篇 按鈕 控制 同樣 道理 範例 中 NXT   機器人 擷取 回 感測器 數值 每次 點選 按鈕 控制 機器人 動作 時 機器人 回傳 一個 確認碼 ／ 位元 告訴 Android   手機 「 已經 正確 接收 指令 執行 完畢 」 這是 網路 傳輸 中 必要 通訊 機制 喔 請要 下載 程式 玩玩 朋友 請 以下 連結 下載 http dl dropbox com u 11288673 NXT ButtonControl apk 掃描 以下 QRCode 唷 註 App   Inventor 伺服器 目前 正由 Google 移轉 麻省理工學院 行動 研究 中心 預計 近日 推出 新 服務 使用 介面 將無 重大 改變 過渡 期間 想要 申請 測試 帳號 讀者 請 以下 連結 申請 http appinventoredu mit edu 註 CAVE 教育 團隊 提供 App   Inventor 指令 中 文化 手冊 請 http www appinventor tw 下載 註 將您 手機 設定 自行 安裝 非 Market 下載 程式 請 參考 http www appinventor tw phone 註 Android 手機 樂高 NXT 主機 連線 詳細 步驟 請 參考 http www appinventor tw connecttonxt 文章 原文 刊載 ROBOCON 國際 中文版 2012 月號 2017   年泛 知識 節   早腦 人必 搶 早 鳥 優惠 開 跑啦 「   領域   x   150   場 分享 體驗 工作坊   x   200   意見 領袖   x   1000   參與者 」 2017   年 兩岸三地 最大 知識 饗宴   –   泛 ・ 知識 節   早鳥票 開賣 由泛 科 知識 旗下   PanSci   科學 新聞網   娛樂 重擊   Punchline PanX   泛 科技 新聞網 聯合 超強 協力 夥伴 邀 兩天 火拼 知識 大腦 做個 版本升級 11 月   11 12   日到 泛 ． 知識 節 直搗 知識 核心 挑戰 創造 未知   ∞   種 手腳 迅速 眼光 精準 早腦 人 還不 速速 搶下 早鳥 優惠 獨家 周邊 商品 購票 還贈   TAAZE   讀冊 生活 折價 卷 早鳥 優惠 只到   10 27 馥林 文化 泰電 電業 股份 有限公司 2002 年 成立 出版部門 鑒 21 世紀 將是 數位 科技 人文 融合 互動 世代 馥林 亦 出版 科技 機械 類雜誌 相關 書籍 馥林 文化 出版 書籍 http www fullon com tw 